<!-- templates/dashboard.html -->
{% extends 'base.html' %}

{% block title %}Dashboard - Remote HA{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h2>Your Home Assistant Sites</h2>
    
    {% if messages %}
    <div class="messages">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    </div>
    {% endif %}
    
    <div class="sites-grid">
        {% for site in sites %}
            <div class="site-card {% if site.ws_connected%}connected{% else %}disconnected{% endif %}">
                <h3>{{ site.name }}</h3>
                <div class="status-indicator"></div>
                <p>Status: {% if site.ws_connected%}Connected{% else %}Disconnected{% endif %}</p>
                {% if site.last_connected %}
                    <p>Last seen: {{ site.last_connected|timesince }} ago</p>
                {% endif %}
                
                <div class="action-buttons">
                    {% if site.ws_connected%}
                        <a href="{% url 'site_interface' site.id %}" class="connect-button">
                            Connect
                        </a>
                    {% else %}
                        <button disabled class="connect-button disabled">
                            Unavailable
                        </button>
                    {% endif %}
                    
                    <a href="{% url 'delete_site' site.id %}" class="delete-button">
                        Delete
                    </a>
                </div>
            </div>
        {% empty %}
            <p>No Home Assistant sites available. Please connect a site first.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}